CREATE OR REPLACE PROCEDURE
  `carto-dw-ac-8l15x5rr.workflows_temp_ernesto_sdscnyc_9fdb3fb4.wfproc_api_d03cd749048aa81c`(
)
BEGIN
  /*
   {"diagramJson":"{\"title\":\"create area from coordinates\",\"description\":\"\",\"nodes\":[{\"id\":\"c8a2fe39-6b56-4a8e-8cd3-541950c9a743\",\"data\":{\"name\":\"native.pointfromstaticlatlon\",\"type\":\"generic\",\"label\":\"Point from Static LatLon\",\"inputs\":[{\"name\":\"lon\",\"type\":\"Number\",\"title\":\"Longitude\",\"min\":-180,\"max\":180,\"description\":\"Longitude\",\"value\":\"{{@longitude}}\"},{\"name\":\"lat\",\"type\":\"Number\",\"title\":\"Latitude\",\"min\":-90,\"max\":90,\"description\":\"Latitude\",\"value\":\"{{@latitude}}\"}],\"version\":\"1\"},\"type\":\"generic\",\"zIndex\":2,\"position\":{\"x\":224,\"y\":224}},{\"id\":\"e98dd39c-d434-4d56-8689-60fff9110fe4\",\"data\":{\"name\":\"native.buffer\",\"type\":\"generic\",\"label\":\"ST Buffer\",\"inputs\":[{\"name\":\"source\",\"type\":\"Table\",\"title\":\"Source table\",\"description\":\"Source table\"},{\"name\":\"geo\",\"type\":\"Column\",\"title\":\"Geo column\",\"parent\":\"source\",\"dataType\":[\"geography\"],\"description\":\"Geo column\",\"value\":\"geo\"},{\"name\":\"distance\",\"type\":\"Number\",\"title\":\"Distance\",\"optional\":true,\"default\":10,\"description\":\"Distance\",\"value\":2000},{\"name\":\"units\",\"type\":\"Selection\",\"title\":\"Units\",\"options\":[\"Meters\",\"Miles\"],\"default\":\"Meters\",\"description\":\"Units\",\"value\":\"Meters\"}],\"version\":\"1\"},\"type\":\"generic\",\"zIndex\":2,\"position\":{\"x\":384,\"y\":224}},{\"id\":\"66e08cb9-4138-4c3e-a497-25f208ac2641\",\"data\":{\"name\":\"native.aswkt\",\"type\":\"generic\",\"label\":\"ST as Text\",\"inputs\":[{\"name\":\"source\",\"type\":\"Table\",\"title\":\"Source table\",\"description\":\"Source table\"},{\"name\":\"geo\",\"type\":\"Column\",\"title\":\"Column with geographies definition\",\"parent\":\"source\",\"dataType\":[\"geography\"],\"description\":\"Column with geographies definition\",\"value\":\"geo_buffer\"}],\"version\":\"1\"},\"type\":\"generic\",\"zIndex\":2,\"position\":{\"x\":496,\"y\":224}},{\"id\":\"8e20fa1a-ff28-48e0-942c-a58bafefacac\",\"data\":{\"name\":\"native.refactorcolumns\",\"type\":\"generic\",\"label\":\"Edit Schema\",\"inputs\":[{\"name\":\"source\",\"type\":\"Table\",\"title\":\"Source table\",\"description\":\"Source table\"},{\"name\":\"columns\",\"type\":\"SelectColumnType\",\"title\":\"Column name and type\",\"parent\":\"source\",\"noDefault\":true,\"providers\":[\"bigquery\",\"snowflake\",\"redshift\",\"postgres\"],\"description\":\"Column name and type\",\"value\":\"geo_buffer_wkt,geo_buffer_wkt,STRING\"}],\"version\":\"2\"},\"type\":\"generic\",\"zIndex\":2,\"position\":{\"x\":624,\"y\":224}},{\"id\":\"eb6eb503-0da2-4cc0-ab89-9d68e9af1998\",\"data\":{\"name\":\"native.mcptooloutput\",\"type\":\"generic\",\"label\":\"MCP Tool Output\",\"inputs\":[{\"name\":\"source\",\"type\":\"Table\",\"title\":\"Source table\",\"description\":\"Source table\"},{\"name\":\"mode\",\"type\":\"Selection\",\"mode\":\"radio\",\"title\":\"Output type\",\"options\":[{\"icon\":\"sync\",\"name\":\"Sync\",\"value\":\"sync\",\"description\":\"Outputs a JSON object with the data and the FQN of the result when the tool is invoked.\"},{\"icon\":\"async\",\"name\":\"Async\",\"value\":\"async\",\"description\":\"When invoked, creates a job and outputs a JSON object with job metadata, including the result table FQN. The result is available once the job is complete.\"}],\"value\":\"sync\",\"default\":\"async\",\"allowExpressions\":false,\"description\":\"Output type\"}],\"version\":\"1\"},\"type\":\"generic\",\"zIndex\":2,\"position\":{\"x\":768,\"y\":224}}],\"edges\":[{\"id\":\"c8a2fe39-6b56-4a8e-8cd3-541950c9a743result-e98dd39c-d434-4d56-8689-60fff9110fe4source\",\"source\":\"c8a2fe39-6b56-4a8e-8cd3-541950c9a743\",\"target\":\"e98dd39c-d434-4d56-8689-60fff9110fe4\",\"sourceHandle\":\"result\",\"targetHandle\":\"source\"},{\"id\":\"e98dd39c-d434-4d56-8689-60fff9110fe4result-66e08cb9-4138-4c3e-a497-25f208ac2641source\",\"source\":\"e98dd39c-d434-4d56-8689-60fff9110fe4\",\"target\":\"66e08cb9-4138-4c3e-a497-25f208ac2641\",\"sourceHandle\":\"result\",\"targetHandle\":\"source\"},{\"id\":\"66e08cb9-4138-4c3e-a497-25f208ac2641result-8e20fa1a-ff28-48e0-942c-a58bafefacacsource\",\"source\":\"66e08cb9-4138-4c3e-a497-25f208ac2641\",\"target\":\"8e20fa1a-ff28-48e0-942c-a58bafefacac\",\"sourceHandle\":\"result\",\"targetHandle\":\"source\"},{\"id\":\"8e20fa1a-ff28-48e0-942c-a58bafefacacresult-eb6eb503-0da2-4cc0-ab89-9d68e9af1998source\",\"source\":\"8e20fa1a-ff28-48e0-942c-a58bafefacac\",\"target\":\"eb6eb503-0da2-4cc0-ab89-9d68e9af1998\",\"sourceHandle\":\"result\",\"targetHandle\":\"source\"}],\"variables\":[{\"name\":\"latitude\",\"type\":\"Number\",\"order\":1,\"value\":\"40.7484\",\"scopes\":[\"mcptool\"]},{\"name\":\"longitude\",\"type\":\"Number\",\"order\":2,\"value\":\"-73.9857\",\"scopes\":[\"mcptool\"]}],\"procedure\":{},\"schedule\":{},\"viewport\":{\"x\":150.66361919706117,\"y\":68.6817895955752,\"zoom\":0.9903428719330246},\"schemaVersion\":\"1.0.0\",\"connectionProvider\":\"bigquery\",\"useCache\":false,\"mcpTool\":{\"id\":\"b6af2b6e-b486-4f9f-9d9b-0b2613fa798c\",\"name\":\"create_area_from_coordinates\",\"draft\":{\"inputs\":{\"latitude\":{\"description\":\"A number that represents the latitude of the desired point in decimal degrees.\"},\"longitude\":{\"description\":\"A number that represents the longitude of the desired point in decimal degrees.\"}},\"output\":{\"description\":\"The output contains a property called geo_buffer_wkt that contains a WKT string with the representation of an area of interest.\"},\"description\":\"This tool takes a pair of coordinates and returns a WKT string representation of an area around the point.\"},\"inputs\":[{\"name\":\"latitude\",\"type\":\"Number\",\"order\":1,\"value\":\"40.7484\",\"description\":\"A number that represents the latitude of the desired point in decimal degrees.\"},{\"name\":\"longitude\",\"type\":\"Number\",\"order\":2,\"value\":\"-73.9857\",\"description\":\"A number that represents the longitude of the desired point in decimal degrees.\"}],\"output\":{\"method\":\"POST\",\"payload\":{\"q\":\"CALL `carto-dw-ac-8l15x5rr.workflows_temp_ernesto_sdscnyc_9fdb3fb4.wfproc_mcptool_d03cd749048aa81c`(@latitude,@longitude)\",\"query\":\"\",\"queryParameters\":{\"latitude\":40.7484,\"longitude\":-73.9857}},\"endpoint\":\"https://gcp-us-east1.api.carto.com/v3/sql/carto_dw/query\",\"description\":\"The output contains a property called geo_buffer_wkt that contains a WKT string with the representation of an area of interest.\"},\"enabled\":true,\"procedure\":{\"call\":\"CALL `carto-dw-ac-8l15x5rr.workflows_temp_ernesto_sdscnyc_9fdb3fb4.wfproc_mcptool_d03cd749048aa81c`(@latitude,@longitude)\",\"hash\":\"e3156f1af6523e36\",\"params\":\"{\\\"latitude\\\":40.7484,\\\"longitude\\\":-73.9857}\",\"status\":\"updated\",\"updatedAt\":1759920798888},\"description\":\"This tool takes a pair of coordinates and returns a WKT string representation of an area around the point.\"}}"}
  */
  DECLARE `latitude` FLOAT64 DEFAULT 40.7484;
  DECLARE `longitude` FLOAT64 DEFAULT -73.9857;
  CREATE TEMPORARY TABLE `WORKFLOW_d03cd749048aa81c_69b02c2b4d2cb41b_result`
  AS
    WITH
    cte_1 AS (
      SELECT ST_GEOGPOINT((`longitude`), (`latitude`)) geo
    ),
    cte_2 AS (
      SELECT ST_BUFFER(geo, 2000) AS geo_buffer, *
      FROM cte_1
    ),
    cte_3 AS (
      SELECT *, ST_ASTEXT(geo_buffer) AS geo_buffer_wkt
      FROM cte_2
    )
    SELECT
      SAFE_CAST(geo_buffer_wkt AS STRING) AS geo_buffer_wkt
    FROM cte_3;
END;